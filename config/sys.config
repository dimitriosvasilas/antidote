[
 %% Riak Core config
 {riak_core, [
              %% Default location of ringstate
              {ring_state_dir, "${RING_STATE_DIR}"},
              {platform_data_dir, "${PLATFORM_DATA_DIR}"},

              %% riak_handoff_port is the TCP port that Riak uses for
              %% intra-cluster data handoff.
              {handoff_port, 8099}
             ]},

  %% logger config
{kernel, [
    {logger, [
    {handler, default, logger_std_h,
      #{level => info,
        formatter => {logger_formatter, #{single_line => false, max_size => 2048}},
        config => #{type => standard_io}}},
   {handler, errors, logger_std_h,
      #{level => error,
        formatter => {logger_formatter, #{single_line => false, max_size => 2048}},
        config => #{type => {file, "logger_logs/errors.log"}}}}
    ]},
    {logger_level, info}
 ]},

 {ranch, [
        {pb_ip, "${PB_IP}"},
        {pb_port, 8087}
        ]},

  {prometheus, [{collectors, [prometheus_process_collector, default]}]},

  {antidote, [
    {pubsub_port, 8086},
    {logreader_port, 8085},
    {metrics_port, 3001}
  ]},
  
  {grpcbox, [
    {servers, [
              #{grpc_opts => #{service_protos => [log_propagation_pb],
                               services => #{'logpropagation.Service' => logpropagation_service
                                         }
			      },

                transport_opts => #{ssl => false},

                listen_opts => #{port => 8080,
                                 ip => {0,0,0,0}},

                pool_opts => #{size => 10},

                server_opts => #{header_table_size => 4096,
                                 enable_push => 1,
                                 max_concurrent_streams => unlimited,
                                 initial_window_size => 65535,
                                 max_frame_size => 16384,
                                 max_header_list_size => unlimited}}]}]
 }

].
